# 1. 页面加载

## 1. 加载资源的形式

1. html 代码
2. 媒体文件，如图片，视频
3. JS，CSS

## 2. 加载资源的过程

1. DNS 解析：域名 -> IP 地址
2. 浏览器根据 IP 地址向服务器发起 HTTP 请求
3. 服务器处理 HTTP 请求，并返回给浏览器

## 3. 渲染的过程

1. 根据 HTML 代码生成 DOM Tree
2. 根据 CSS 代码生成 CSSOM
3. 将 DOM Tree 和 CSSOM 整合成 Render Tree
4. 根据 Render Tree 渲染页面
5. 遇到 Script 则暂停渲染，优先加载并执行 JS 代码，因为 JS 有可能会改变 DOM， 完成再继续
6. 直至把 Render Tree 渲染完成

## 4. window.onload 和 DOMContentLoaded

1. `window.onload`：页面全部资源加载完才会执行，包括图片和视频
2. `DOMContentLoaded`：DOM 渲染完即刻执行，此时图片和视频可能没有加载完

## 5. 从输入 url 到渲染出页面的整个过程

1. 通过 DNS 将 URL 解析成 IP 地址
   - hosts 文件和 hosts 缓存
   - 本地 DNS -> 根 DNS -> 顶级 DNS -> 权威 DNS
2. 检查浏览器是否有缓存
3. 与 WEB 服务器建立 TCP/IP 三次握手连接
4. 浏览器向 WEB 服务器发送 HTTP 请求
5. 服务器响应请求
6. 浏览器解析 HTML, 渲染页面
   - DOM 树：解析 HTML 构建 DOM(DOM 树)
   - CSS 树：解析 CSS 构建 CSSOM(CSS 树)
   - 渲染树：CSSOM 和 DOM 一起生成 Render Tree(渲染树)
     - 布局（layout）：根据 Render Tree 浏览器就知道网页中有哪些节点，以及各个节点与 CSS 的关系，从而知道每个节点的位置和几何属性（重排）
   - 绘制（Paint）：根据计算好的信息绘制整个页面（重绘）
7. 四次挥手断开连接

# 2. 性能优化

## 1. 原则

1. 多使用内存，缓存
2. 减少 CPU 计算量，减少网络加载耗时
3. 空间换时间

## 2. 如何入手

### 1. 加载更快

1. 减少资源体积：压缩代码
2. 减少访问次数：
   - 合并代码
   - SSR 服务器端渲染，将网页和数据一起加载
   - 缓存: 静态资源加 content hash 后缀
3. 使用更快的网络：CDN

### 2. 渲染更快

1. CSS 放在 head，JS 放在 body 最下面
2. 没必要等到（DOM，图片，视频）全部加载完再执行 JS，可以用 `DOMContentLoaded` 等 DOM 加载完马上执行 JS
3. 懒加载（图片懒加载，上滑加载更多）
4. 对 DOM 查询进行缓存
5. 把频繁 DOM 操作，合并到一起进行一次性操作
6. 节流 throttle 和防抖 debounce

## 3. 防抖 debounce

1. 原理：在事件被触发 n 秒后再执行回调，如果在这 n 秒内事件又被触发，则重新计时
2. 应用场景：typeahead
   - 监听一个输入框，文字变化后触发 change 事件
   - 如果直接用 keyup 事件，会频繁触发 change 事件
   - 防抖：当用户输入结束或者暂停时，才触发 change 事件

## 4. 节流 throttle

1. 原理：规定在一个单位时间内只能执行一次回调，如果在同一时间单位内某事件多次被触发，只有一次能生效
2. 应用场景：resize， 拖拽

# 3. 网络安全

## 1. XSS 跨站请求攻击

1. 什么是 XSS 攻击？Cross-Site Scripting
   - 攻击者注入恶意的代码到受害者的网页当中，当用户浏览网页时触发代码，从而获取用户的敏感信息
2. 如何防范
   - 对用户输入的内容进行过滤和转义，避免恶意的脚本代码注入到网页当中
   - 使用 CSP（content security policy）等技术来增强网站安全
     - CSP 通过指定服务器端的白名单来控制浏览器只能执行特定来源的代码和资源
     - 它使用 HTTP 响应头部中的 content-security-policy 字段来指定白名单

## 2. CSRF 跨站请求伪造

1. 什么是 CSRF 攻击？Cross-Site Request Forgery
   - 原理：攻击者通过伪造用户的请求来执行未经授权的操作
   - 例子：攻击者诱骗用户点击恶意链接，该连接使用户浏览器执行针对目标网站的请求。如果用户已经登陆目标网站，则该请求将在用户不知情的情况下使用其已登陆的凭证进行验证，从而使攻击者在目标网站上能够执行任何他们想要的操作，如改密码，删除账号等
2. 如何防范
   - 使用 POST
   - 在表单中添加 token，该 token 与用户登录时获得的 token 比较，如果相同服务器才会执行该请求
   - 增加验证，如密码，指纹，短信验证码
